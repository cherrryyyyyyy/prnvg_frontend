(function(){var t={13041:function(t,e,a){"use strict";var s=a(66848),l=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},o=[],i={name:"app"},n=i,r=a(81656),c=(0,r.A)(n,l,o,!1,null,null,null),d=c.exports,h=a(15596),u=a.n(h),p=a(64660),f=a.n(p),g=a(23832),m=a.n(g),v=a(94355),_=a.n(v),y=a(8178),b=a.n(y),T=a(24856),w=a.n(T),C=a(11612),x=a.n(C),k=a(88088),S=a.n(k),A=a(29373),D=a.n(A),z=a(95441),$=a.n(z),E=a(83950),W=a.n(E),G=a(16034),O=a.n(G),q=a(74351),j=a.n(q),M=a(41442),B=a.n(M),I=a(70664),L=a.n(I),F=a(69008),N=a.n(F),R=a(7358),P=a.n(R),V=a(76287),H=a.n(V),J=a(55614),U=a.n(J),Y=a(64932),K=a.n(Y),X=a(38296),Q=a.n(X),Z=a(40707),tt=a.n(Z),et=a(74783),at=a.n(et),st=a(84806),lt=a.n(st),ot=a(8900),it=a.n(ot),nt=a(12025),rt=a.n(nt),ct=a(42525),dt=a.n(ct),ht=a(95125),ut=a.n(ht),pt=a(86272),ft=a.n(pt),gt=a(63797),mt=a.n(gt),vt=a(50353),_t=a.n(vt),yt=a(23952),bt=a.n(yt),Tt=a(60630),wt=a.n(Tt),Ct=a(51120),xt=a.n(Ct),kt=a(28858),St=a.n(kt),At=a(54245),Dt=a.n(At),zt=a(83715),$t=a.n(zt),Et=a(874),Wt=a.n(Et),Gt=a(95790),Ot=a.n(Gt),qt=a(29881),jt=a.n(qt),Mt=a(66063),Bt=a.n(Mt),It=a(90167),Lt=a.n(It),Ft=a(62063),Nt=a.n(Ft),Rt=a(61443),Pt=a.n(Rt),Vt=a(90685),Ht=a.n(Vt),Jt=a(67705),Ut=a.n(Jt),Yt=a(59384),Kt=a.n(Yt),Xt=a(67386),Qt=a.n(Xt),Zt=a(32672),te=a.n(Zt),ee=a(94054),ae=a.n(ee),se=a(65345),le=a.n(se),oe=a(2179),ie=a.n(oe),ne=a(68082),re=a.n(ne),ce=a(56210),de=a.n(ce),he=a(21275),ue=a.n(he),pe=a(74621),fe=a.n(pe),ge=a(29507),me=a.n(ge),ve=a(23436),_e=a.n(ve),ye=a(11362),be=a.n(ye),Te=a(25319),we=a.n(Te),Ce=a(88339),xe=a.n(Ce),ke=a(19940),Se=a.n(ke),Ae=a(66535),De=a.n(Ae),ze=a(61178),$e=a.n(ze),Ee=a(59237),We=a.n(Ee),Ge=a(84902),Oe=a.n(Ge),qe=a(80544),je=a.n(qe),Me=a(62381),Be=a.n(Me),Ie=a(11227),Le=a.n(Ie),Fe=a(92736),Ne=a.n(Fe),Re=a(10406),Pe=a.n(Re),Ve=a(6870),He=a.n(Ve),Je=a(42916),Ue=a.n(Je),Ye=a(31604),Ke=a.n(Ye),Xe=a(38228),Qe=a.n(Xe),Ze=a(66782),ta=a.n(Ze),ea=a(55235),aa=a.n(ea),sa=a(90175),la=a.n(sa),oa=a(17999),ia=a.n(oa);s["default"].use(ia()),s["default"].use(la()),s["default"].use(aa()),s["default"].use(ta()),s["default"].use(Qe()),s["default"].use(Ke()),s["default"].use(Ue()),s["default"].use(He()),s["default"].use(Pe()),s["default"].use(Ne()),s["default"].use(Le()),s["default"].use(Be()),s["default"].use(je()),s["default"].use(Oe()),s["default"].use(We()),s["default"].use($e()),s["default"].use(De()),s["default"].use(Se()),s["default"].use(xe()),s["default"].use(we()),s["default"].use(be()),s["default"].use(_e()),s["default"].use(me()),s["default"].use(fe()),s["default"].use(ue()),s["default"].use(de()),s["default"].use(re()),s["default"].use(ie()),s["default"].use(le()),s["default"].use(ae()),s["default"].use(te()),s["default"].use(Qt()),s["default"].use(Kt()),s["default"].use(Ut()),s["default"].use(Ht()),s["default"].use(Pt()),s["default"].use(Nt()),s["default"].use(Lt()),s["default"].use(Bt()),s["default"].use(jt()),s["default"].use(Ot()),s["default"].use(Wt()),s["default"].use($t()),s["default"].use(Dt()),s["default"].use(St()),s["default"].use(xt()),s["default"].use(wt()),s["default"].use(bt()),s["default"].use(_t()),s["default"].use(mt()),s["default"].use(ft()),s["default"].use(ut()),s["default"].use(dt()),s["default"].use(rt()),s["default"].use(it()),s["default"].use(lt()),s["default"].use(at()),s["default"].use(tt()),s["default"].use(Q()),s["default"].use(K()),s["default"].use(U()),s["default"].use(H()),s["default"].use(P()),s["default"].use(N()),s["default"].use(L()),s["default"].use(B()),s["default"].use(j()),s["default"].use(O()),s["default"].use(W()),s["default"].use($()),s["default"].use(D()),s["default"].use(S()),s["default"].use(x()),s["default"].use(w()),s["default"].use(b()),s["default"].use(_().directive),s["default"].prototype.$loading=_().service,s["default"].prototype.$msgbox=m(),s["default"].prototype.$alert=m().alert,s["default"].prototype.$confirm=m().confirm,s["default"].prototype.$prompt=m().prompt,s["default"].prototype.$notify=f(),s["default"].prototype.$message=u();var na=a(56178),ra=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout"},[e("div",{staticClass:"menu"},[e("Menu",{attrs:{is_collapse:t.is_collapse},on:{changeMenu:t.changeMenu}})],1),e("div",{staticClass:"content",class:{small:t.is_collapse}},[e("Content",{attrs:{is_collapse:t.is_collapse}})],1)])},ca=[],da=function(){var t=this,e=t._self._c;return e("div",[e("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":t.$route.path,"background-color":"#091527","text-color":"#fff","active-text-color":"#ffd04b",router:"",collapse:t.is_collapse}},[e("el-menu-item",{attrs:{index:""}},[e("i",{staticClass:"el-icon-s-operation",on:{click:t.changeMenu}}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("威胁狩猎系统")])]),e("el-menu-item",{attrs:{index:"/"}},[e("i",{staticClass:"el-icon-s-home"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("主页")])]),e("el-menu-item",{attrs:{index:"/alert/index"}},[e("i",{staticClass:"el-icon-bell"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("告警")])]),e("el-menu-item",{attrs:{index:"/dashboard/index"}},[e("i",{staticClass:"el-icon-pie-chart"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("仪表盘")])]),e("el-menu-item",{attrs:{index:"/case/index"}},[e("i",{staticClass:"el-icon-postcard"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("事件")])]),e("el-menu-item",{attrs:{index:"/danger/index"}},[e("i",{staticClass:"el-icon-aim"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("行为详情")])]),e("el-menu-item",{attrs:{index:"/matrix/index"}},[e("i",{staticClass:"el-icon-s-grid"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("攻击矩阵")])]),e("el-menu-item",{attrs:{index:"/rules/index"}},[e("i",{staticClass:"el-icon-coordinate"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("规则库")])])],1)],1)},ha=[],ua={props:["is_collapse"],methods:{changeMenu(){this.$emit("changeMenu")}}},pa=ua,fa=(0,r.A)(pa,da,ha,!1,null,"4922447b",null),ga=fa.exports,ma=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},va=[],_a={},ya=_a,ba=(0,r.A)(ya,ma,va,!1,null,null,null),Ta=ba.exports,wa={components:{Menu:ga,Content:Ta},data(){return{is_collapse:!1}},methods:{changeMenu(){this.is_collapse=!this.is_collapse}}},Ca=wa,xa=(0,r.A)(Ca,ra,ca,!1,null,"5a6b7882",null),ka=xa.exports,Sa=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},Aa=[],Da={data(){return{}},methods:{}},za=Da,$a=(0,r.A)(za,Sa,Aa,!1,null,null,null),Ea=$a.exports,Wa=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:8}},[e("div",{staticClass:"grid-content bg-purple"},[e("el-dropdown",{attrs:{trigger:"click","hide-on-click":!0}},[e("el-button",{attrs:{type:"primary"}},[t._v(" 选择源"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{staticClass:"lang-select-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(this.hosts,(function(a){return e("el-dropdown-item",{key:a.value,nativeOn:{click:function(e){return t.refresh(a.value)}}},[t._v(" "+t._s(a.value)+" ")])})),1)],1)],1)]),e("el-col",{attrs:{span:11}},[e("div",{staticClass:"grid-content bg-purple"},[e("el-button",{attrs:{type:"primary"},on:{click:t.open}},[t._v("点击添加查询对象")])],1)]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"grid-content bg-purple"},[e("el-button",{staticStyle:{"text-align":"left"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.Search}},[t._v("搜索")])],1)])],1)],1),e("div",{staticClass:"wrapper"},t._l(t.columns,(function(a,s){return e("el-col",{attrs:{span:1.5}},[e("el-card",{class:{customcard1:t.judge[s]},attrs:{shadow:"hover"},nativeOn:{click:function(e){return t.handleClick.apply(null,arguments)}}},[e("h3",[t._v(t._s(a))])]),t._l(t.rows[s],(function(a,l){return e("div",[e("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"},on:{show:function(e){return t.show(l)}}},[e("el-table",{attrs:{data:t.dData}},[e("el-table-column",{attrs:{width:"150",property:"external_references[0].external_id",label:"攻击技术id"}}),e("el-table-column",{attrs:{width:"200",property:"description",label:"描述","show-overflow-tooltip":"true"}})],1),t.test(t.datas[l],s)?e("el-card",{class:{customcard:t.datas[l]},attrs:{slot:"reference",shadow:"hover"},nativeOn:{click:function(e){return t.handleClick(l)}},slot:"reference"},[e("el-row",[e("el-col",{attrs:{span:23}},[t._v(" "+t._s(a)+" ")]),e("el-col",{attrs:{span:1}},[e("el-badge",{staticClass:"item",attrs:{value:t.datas[l]}},[e("p",[t._v("  ")])])],1)],1)],1):t._e()],1)],1)})),t._l(t.rows[s],(function(a,s){return e("div",[e("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"},on:{show:function(e){return t.show(s)}}},[e("el-table",{attrs:{data:t.dData}},[e("el-table-column",{attrs:{width:"150",property:"external_references[0].external_id",label:"攻击技术id"}}),e("el-table-column",{attrs:{width:"200",property:"description",label:"描述","show-overflow-tooltip":"true"}})],1),t.datas[s]?t._e():e("el-card",{class:{customcard:t.datas[s]},attrs:{slot:"reference",shadow:"hover"},nativeOn:{click:function(e){return t.handleClick(s)}},slot:"reference"},[e("el-row",[e("el-col",{attrs:{span:23}},[t._v(" "+t._s(a)+" ")]),e("el-col",{attrs:{span:1}},[e("el-badge",{staticClass:"item",attrs:{value:t.datas[s]}},[e("p",[t._v("  ")])])],1)],1)],1)],1)],1)}))],2)})),1)])},Ga=[],Oa=(a(44114),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(94373));const qa=Oa.A.create({baseURL:"/api"});qa.interceptors.request.use((t=>(console.log(t,"发送请求前config信息"),t)),(t=>Promise.reject(t))),qa.interceptors.response.use((t=>(console.log("接受的数据"),t.data)),(t=>Promise.reject(t)));var ja=qa;const Ma=t=>ja.get("/getLogs",{params:t}),Ba=t=>ja.get("/update_escalated_log",{params:t}),Ia=t=>ja.get("/getAlert",{params:t}),La=t=>ja.get("/update_escalated",{params:t}),Fa=t=>ja.get("/getNodeLog",{params:t}),Na=t=>ja.get("/update_case_log",{params:t});var Ra={data(){return{value:"10",checked:!0,optionss:[],threatlogs:[],hosts:[],techniques:[],dData:[],columns:{TA0043:"侦察目标",TA0042:"资源准备",TA0001:"初始访问",TA0002:"攻击执行",TA0003:"持续控制",TA0004:"权限提升",TA0005:"防御规避",TA0006:"凭据访问",TA0007:"环境观察",TA0008:"横向移动",TA0009:"收集信息",TA0011:"命令与控制",TA0010:"窃取数据",TA0040:"侵害破坏"},rows:{TA0043:{T1595:"主动扫描",T1592:"收集受害者主机信息",T1589:"收集受害者身份信息",T1590:"收集受害者网络信息",T1591:"收集受害者组织信息",T1598:"网络钓鱼获取信息",T1597:"搜索闭源",T1596:"搜索开放技术数据库",T1593:"搜索开放网站/域",T1594:"搜索受害者拥有的网站"},TA0042:{T1650:"获取访问权限",T1583:"获取基础架构",T1586:"泄露帐户",T1584:"折衷基础架构",T1587:"发展能力",T1585:"建立账户",T1588:"获取能力",T1608:"舞台功能"},TA0001:{T1189:"偷渡式妥协",T1190:"利用面向公众的应用程序",T1133:"外部远程服务",T1200:"硬件添加",T1566:"网络钓鱼",T1091:"通过可移动媒体进行复制",T1195:"供应链妥协",T1199:"信任关系",T1078:"有效帐户"},TA0002:{T1651:"云管理命令",T1059:"命令和脚本解释器",T1609:"容器管理命令",T1610:"部署容器",T1203:"利用客户端执行",T1559:"进程间通信",T1106:"原生接口",T1053:"计划任务/作业",T1648:"无服务器执行",T1129:"共享模块",T1072:"软件部署工具",T1569:"系统服务",T1204:"用户执行",T1047:"WMI服务"},TA0003:{T1098:"账户操纵",T1197:"位作业",T1547:"启动或登录自动启动执行",T1037:"启动或登录初始化脚本",T1176:"浏览器扩展",T1554:"泄露客户端软件二进制文件",T1136:"创建帐户",T1543:"创建或修改系统进程",T1546:"事件触发的执行",T1133:"外部远程服务",T1574:"劫持执行流程",T1525:"植入物内部图像",T1556:"修改身份验证过程",T1137:"办公应用程序启动",T1542:"预操作系统启动",T1053:"计划任务/作业",T1505:"服务器软件组件",T1205:"交通信号",T1078:"有效帐户"},TA0004:{T1548:"滥用提升控制机制",T1134:"访问令牌操作",T1547:"启动或登录自动启动执行",T1037:"启动或登录初始化脚本",T1543:"创建或修改系统进程",T1484:"域策略修改",T1611:"逃生到主机",T1546:"事件触发的执行",T1068:"利用特权升级",T1574:"劫持执行流程",T1055:"工艺注入",T1053:"计划任务/作业",T1078:"有效账户"},TA0005:{T1548:"滥用提升控制机制",T1134:"访问令牌操作",T1197:"位作业",T1612:"在主机上构建映像",T1622:"调试器规避",T1140:"对文件或信息进行解密/解码",T1610:"部署容器",T1006:"直接卷访问",T1484:"域策略修改",T1480:"执行护栏",T1211:"用于防御规避的利用",T1222:"文件和目录权限修改",T1564:"隐藏工件",T1574:"劫持执行流程",T1562:"损害防御",T1070:"指标移除",T1202:"间接命令执行",T1036:"伪装",T1556:"修改身份验证过程",T1578:"修改云计算基础架构",T1112:"修改注册表",T1601:"修改系统映像",T1599:"网络边界桥接",T1027:"混淆的文件或信息",T1647:"Plist文件修改",T1542:"预操作系统启动",T1055:"工艺注入",T1620:"反射代码加载",T1207:"恶意域控制器",T1014:"根套件",T1553:"颠覆信任控制",T1218:"系统二进制代理执行",T1216:"系统脚本代理执行",T1221:"模板注入",T1205:"交通信号",T1127:"受信任的开发人员实用程序代理执行",T1535:"未使用/不支持的云区域",T1550:"使用备用身份验证材料",T1078:"有效帐户",T1497:"虚拟化/沙盒规避",T1600:"削弱加密",T1220:"XSL 脚本处理"},TA0006:{T1557:"中间的对手",T1110:"蛮 力",T1555:"密码存储中的凭据",T1212:"利用凭据访问",T1187:"强制身份验证",T1606:"伪造网络凭据",T1056:"输入捕获",T1556:"修改身份验证过程",T1111:"多重身份验证拦截",T1621:"多重身份验证请求生成",T1040:"网络嗅探",T1003:"操作系统凭据转储",T1528:"窃取应用程序访问令牌",T1649:"窃取或伪造身份验证证书",T1558:"偷或伪造科贝罗斯门票",T1539:"窃取网络会话Cookie",T1552:"不安全的凭据"},TA0007:{T1087:"帐户发现",T1010:"应用程序窗口发现",T1217:"浏览器信息发现",T1580:"云基础架构发现",T1538:"云服务仪表板",T1526:"云服务发现",T1619:"云存储对象发现",T1613:"容器和资源发现",T1622:"调试器规避",T1652:"设备驱动程序发现",T1482:"域信任发现",T1083:"文件和目录发现",T1615:"组策略发现",T1046:"网络服务发现",T1135:"网络共享发现",T1040:"网络嗅探",T1201:"密码策略发现",T1120:"外围设备发现",T1069:"权限组发现",T1057:"进程发现",T1012:"查询注册表",T1018:"远程系统发现",T1518:"软件发现",T1082:"系统信息发现",T1614:"系统位置发现",T1016:"系统网络配置发现",T1049:"系统网络连接发现",T1033:"系统所有者/用户发现",T1007:"系统服务发现",T1124:"系统时间发现",T1497:"虚拟化/沙盒规避"},TA0008:{T1210:"利用远程服务",T1534:"内部鱼叉式网络钓鱼",T1570:"横向刀具转移",T1563:"远程服务会话劫持",T1021:"远程服务",T1091:"通过可移动媒体进行复制",T1072:"软件部署工具",T1080:"污点共享内容",T1550:"使用备用身份验证材料"},TA0009:{T1557:"中间的对手",T1560:"存档收集的数据",T1123:"音频捕获",T1119:"自动收集",T1185:"浏览器会话劫持",T1115:"剪贴板数据",T1530:"来自云存储的数据",T1602:"来自配置存储库的数据",T1213:"来自信息存储库的数据",T1005:"来自本地系统的数据",T1039:"来自网络共享云端硬盘的数据",T1025:"来自可移动媒体的数据",T1074:"数据暂存",T1114:"电子邮件收集",T1056:"输入捕获",T1113:"屏幕截图",T1125:"视频捕获"},TA0011:{T1071:"应用层协议",T1092:"通过可移动媒体进行通信",T1132:"数据编码",T1001:"数据混淆",T1568:"动态分辨率",T1573:"加密通道",T1008:"回退通道",T1105:"入口工具传输",T1104:"多级通道",T1095:"非应用层协议",T1571:"非标端口",T1572:"协议隧道",T1090:"代理",T1219:"远程访问软件",T1205:"交通信号",T1102:"网络服务"},TA0010:{T1020:"自动渗透",T1030:"数据传输大小限制",T1048:"替代协议的渗透",T1041:"通过 C2 通道渗出",T1011:"通过其他网络介质进行外泄",T1052:"物理介质上的渗漏",T1567:"通过 Web 服务进行渗透",T1029:"定时接送",T1537:"将数据传输到云帐户"},TA0040:{T1531:"帐户访问权限删除",T1485:"数据销毁",T1486:"为影响而加密的数据",T1565:"数据操作",T1491:"污损",T1561:"磁盘擦除",T1499:"终端拒绝服务",T1495:"固件损坏",T1490:"抑制系统恢复",T1498:"网络拒绝服务",T1496:"资源劫持",T1489:"服务停止",T1529:"系统关机/重启"}},datas:{},judge:{TA0043:!1,TA0042:!1,TA0001:!1,TA0002:!1,TA0003:!1,TA0004:!1,TA0005:!1,TA0006:!1,TA0007:!1,TA0008:!1,TA0009:!1,TA0011:!1,TA0010:!1,TA0040:!1}}},methods:{test(t,e){return null!=t&&(this.judge[e]=!0,!0)},showPopover(){console.log("show")},handleClick(t){console.log("Click",t),this.showdetail(t)},showdetail(t){this.$router.push({path:"/matrix/detail",query:{index:t}})},show(t){this.dData=[],this.getjson(t),console.log(this.dData)},async getjson(t){this.dData=[],await Oa.A.get("http://"+location.host+"/technique/"+t+".json").then((t=>{console.log(t.data.objects[0],"res"),200==t.status?this.dData.push(t.data.objects[0]):alert("数据获取失败")})),console.log("gridData",this.dData)},Search(){console.log("search!!")},open(){this.$prompt("请输入查询对象index","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:t})=>{this.$message({type:"success",message:"成功添加对象: "+t})})).catch((()=>{this.$message({type:"info",message:"取消输入"})}))},async GetThreatLogs(){let t=await Ma();this.threatlogs=t,console.log(this.threatlogs),this.gethosts();let e=new Set;for(let s of this.threatlogs)e.add(s.technique_id);let a=Array.from(e);this.techniques=a;for(let s of this.techniques)console.log(s),this.datas[s]=0;for(let s of this.threatlogs)for(let t in this.datas)s.technique_id==t&&s.host==this.hosts[0].value&&this.datas[t]++;console.log(this.datas)},gethosts(){let t=new Set;for(let a of this.threatlogs)t.add(a.host);let e=Array.from(t);for(let a of e){let t={value:a,label:a};this.hosts.push(t)}this.host=this.hosts[0].value,console.log(this.hosts)},refresh(t){console.log(t),this.judge={TA0043:!1,TA0042:!1,TA0001:!1,TA0002:!1,TA0003:!1,TA0004:!1,TA0005:!1,TA0006:!1,TA0007:!1,TA0008:!1,TA0009:!1,TA0011:!1,TA0010:!1,TA0040:!1},this.datas={};for(let e of this.threatlogs)e.host==t&&(this.datas[e.technique_id]=0);for(let e of this.threatlogs)for(let a in this.datas)e.technique_id==a&&e.host==t&&this.datas[a]++}},created(){this.GetThreatLogs()}},Pa=Ra,Va=(0,r.A)(Pa,Wa,Ga,!1,null,null,null),Ha=Va.exports,Ja=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},Ua=[],Ya={data(){return{}},methods:{}},Ka=Ya,Xa=(0,r.A)(Ka,Ja,Ua,!1,null,null,null),Qa=Xa.exports,Za=function(){var t=this,e=t._self._c;return e("div",[t._m(0),e("div",{staticClass:"wrapper1"},[e("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"true",data:t.ruleForm,height:"590",border:""}},[e("el-table-column",{attrs:{prop:"id",label:"攻击行为id",width:"200",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"tactic_name",label:"攻击行为名称",width:"300",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"technique_id",label:"攻击技术id",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"technique_name",label:"攻击技术名称",width:"300",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.StrategyDetail(a.$index,a.row)}}},[t._v("详情")])]}}])})],1)],1)])},ts=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header1"},[e("h3",[t._v(" 攻击行为详情 ")])])}],es={data(){return{ruleForm:[{id:"TA0010",tactic_name:"窃取数据",technique_id:"T1052",technique_name:"物理介质上的渗漏"},{id:"TA0043",tactic_name:"侦察目标",technique_id:"T1598",technique_name:"网络钓鱼获取信息"}]}},methods:{StrategyDetail(t,e){console.log(t,e),console.log(e),this.showdetail(e)},showdetail(t){this.$router.push({path:"/danger/detail",query:{index:t}})}}},as=es,ss=(0,r.A)(as,Za,ts,!1,null,null,null),ls=ss.exports,os=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 漏洞资源详情 ")],1)]),e("div",{staticClass:"wrapper"},[e("el-descriptions",{attrs:{column:"1",border:""}},[e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.id)+" ")])])],1)],1)])},is=[],ns={data(){return{data:[]}},methods:{Goback(){this.$router.push("/danger/index")},detail_init(){this.data=this.$route.query.index,console.log(this.data)}},created(){this.detail_init()}},rs=ns,cs=(0,r.A)(rs,os,is,!1,null,"8b13cce4",null),ds=cs.exports,hs=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header1"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" "+t._s(this.$route.query.index)+"技术详情 ")],1)]),e("div",{staticClass:"wrapper1"},[e("el-descriptions",{attrs:{column:"2",border:""}},[e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.Data.created)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("ID")]),e("div",{staticClass:"fontClass"},[t._v(" 12341241234 ")])])],1)],1)])},us=[],ps={methods:{Goback(){this.$router.push("/matrix/index")},detail_init(){Oa.A.get("http://"+location.host+"/technique/"+this.key+".json").then((t=>{console.log(t.data.objects[0],"res"),200==t.status?this.Data=t.data.objects[0]:alert("数据获取失败")}))}},data(){return{key:0,Data:{}}},created(){this.key=this.$route.query.index,console.log(this.key),this.detail_init()}},fs=ps,gs=(0,r.A)(fs,hs,us,!1,null,"c98af54e",null),ms=gs.exports,vs=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},_s=[],ys={data(){return{}},methods:{}},bs=ys,Ts=(0,r.A)(bs,vs,_s,!1,null,null,null),ws=Ts.exports,Cs=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header1"},[e("h3",{attrs:{color:"white"}},[t._v(" 仪表盘                               "),e("el-dropdown",{attrs:{trigger:"click","hide-on-click":!0}},[e("span",{staticClass:"el-dropdown-link",staticStyle:{color:"antiquewhite"}},[t._v(" 选择源"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{staticClass:"lang-select-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(this.hosts,(function(a){return e("el-dropdown-item",{key:a.value,nativeOn:{click:function(e){return t.refresh(a.value)}}},[t._v(" "+t._s(a.value)+" ")])})),1)],1)],1)]),e("div",{staticClass:"wrapper1"},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"},[e("h1",[t._v(" 主机："+t._s(this.host)+" ")])])])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content bg-purple-dark"},[e("h1",[t._v(" 基本信息 ")])])])],1),e("el-row",[e("el-col",{attrs:{span:8}},[e("div",[e("div",{staticClass:"echart",style:t.myChartStyle,attrs:{id:"mychart"}})])]),e("el-col",{attrs:{span:8}},[e("div",[e("div",{staticClass:"echart",style:t.myChartStyle,attrs:{id:"mychartlogs"}})])]),e("el-col",{attrs:{span:8}},[e("div",[e("div",{staticClass:"echart",style:t.myChartStyle,attrs:{id:"mycharttimeline"}})])])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content bg-purple-dark"},[e("h1",[t._v(" 主机告警桑基图 ")])])])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"},[e("div",[e("div",{staticClass:"echart",style:t.myChartStyle1,attrs:{id:"sankey"}})])])])],1)],1)])},xs=[],ks=a(89671),Ss={data(){return{myChartStyle:{float:"left",width:"70%",height:"250px"},threatlogs:[],myChartStyle1:{float:"left",width:"100%",height:"400px"},tactics:[],host:"",hosts:[]}},methods:{initEchartsbar(){let t=new Set;for(let o of this.threatlogs)t.add(o.tactic_id);let e=[],a=0,s=Array.from(t);this.tactics=s;for(let o of s){e[a]=0;for(let t of this.threatlogs)t.tactic_id==o&&t.host==this.hosts[0].value&&e[a]++;a++}const l={title:{text:"行为统计",x:"center",textStyle:{fontSize:20,fontStyle:"italic",fontWeight:"bold"}},xAxis:{name:"技术",data:s},yAxis:{name:"告警个数"},series:[{type:"bar",data:e,label:{show:!0,position:"top"},barWidth:"30%"}]};this.myChartbar=ks.Ts(document.getElementById("mychart")),this.myChartbar.setOption(l),window.addEventListener("resize",(()=>{this.myChartbar.resize()}))},initEchartslogs(){const t={title:{text:"日志统计",x:"center",textStyle:{fontSize:20,fontStyle:"italic",fontWeight:"bold"}},xAxis:{name:"类型",data:["1","2","3"]},yAxis:{name:"日志个数"},series:[{type:"bar",data:[1,3,4],label:{show:!0,position:"top"},barWidth:"30%"}]};this.myChartlog=ks.Ts(document.getElementById("mychartlogs")),this.myChartlog.setOption(t),window.addEventListener("resize",(()=>{this.myChartlog.resize()}))},initEchartstimeline(){const t={title:{text:"时间线统计",x:"center",textStyle:{fontSize:20,fontStyle:"italic",fontWeight:"bold"}},xAxis:{name:"时间线",type:"category",data:["1","2","3"]},yAxis:{type:"value",name:"告警个数"},series:[{type:"line",data:[1,3,4],label:{show:!0,position:"top"},barWidth:"30%"}]};this.myCharttimeline=ks.Ts(document.getElementById("mycharttimeline")),this.myCharttimeline.setOption(t),window.addEventListener("resize",(()=>{this.myCharttimeline.resize()}))},initSankey(){let t=[];for(let o of this.tactics){let e={name:"",value:0,depth:1,itemStyle:{color:""}};e.name=o,e.value=0,e.itemStyle.color=this.getRandomColor(),console.log(e),t.push(e)}let e=0;for(let o of this.threatlogs)for(let a of t)o.tactic_id==a.name&&o.host==this.hosts[0].value&&(a.value+=1,e+=1);console.log(t);let a={name:this.hosts[0].value,value:e,depth:0,itemStyle:{color:"#7BA2DF"}};t.push(a);let s=[];for(let o of t){let t={source:this.hosts[0].value,target:"",value:0};1==o.depth&&(t.target=o.name,t.value=o.value,s.push(t))}console.log(s);const l={tooltip:{trigger:"item",triggerOn:"mousemove",rich:{a:{fontSize:14,fontWeight:500,color:"#fff",padding:[0,0,5,0]}},formatter:function(t){return t.data.source?`${t.data.source}-${t.data.target}：${t.data.value}`:`${t.name}：${t.value}`}},series:{type:"sankey",layout:"none",top:"1%",bottom:"1%",left:"0",right:"16.5%",draggable:!1,focusNodeAdjacency:"allEdges",lineStyle:{opacity:.3,color:"gradient",curveness:.7},label:{color:"#000",fontSize:15,formatter:function(t){if(0===t.data.depth&&"本科生"===t.data.name)return"{a|"+t.data.name+"\n}{b|"+t.data.value+"}";if(0===t.data.depth&&"硕士研究生"===t.data.name)return"{a2|"+t.data.name+"\n}{b2|"+t.data.value+"}";if(0===t.data.depth&&"博士研究生"===t.data.name)return"{a3|"+t.data.name+"\n}{b3|"+t.data.value+"}";if(1===t.data.depth)return"{c|"+t.data.name+"}{d|"+t.data.value+"}";if(2===t.data.depth){let e="";return t.data.typeArr.forEach((a=>{e+="{m|"+t.data.name+"/"+a.typeName+"}{n|"+a.value+"\n}"})),e}},rich:{a:{fontSize:14,fontWeight:500,color:"#7BA2DF",padding:[0,0,5,0]},b:{fontSize:24,fontWeight:600,color:"#7BA2DF",padding:[0,0,0,0]},a2:{fontSize:14,fontWeight:500,color:"#BA86ED",padding:[0,0,5,0]},b2:{fontSize:24,fontWeight:600,color:"#BA86ED",padding:[0,0,0,0]},a3:{fontSize:14,fontWeight:500,color:"#59DEC6",padding:[0,0,5,0]},b3:{fontSize:24,fontWeight:600,color:"#59DEC6",padding:[0,0,0,0]},c:{fontSize:16,color:"#332D2D",lineHeight:20},d:{fontSize:16,fontWeight:600,lineHeight:20,color:"#332D2D ",padding:[0,0,0,2]},e:{fontSize:14,fontWeight:500,color:"#332D2D",padding:[0,0,5,0]},f:{fontSize:16,fontWeight:600,color:"#332D2D",padding:[0,0,20,0]},m:{fontSize:14,fontWeight:500,color:"#332D2D",padding:[0,0,0,0]},n:{fontSize:16,fontWeight:600,color:"#332D2D",padding:[0,0,0,10]}}},nodeGap:20,layoutIterations:0,emphasis:{focus:"adjacency"},data:t,links:s}};this.myChartsankey=ks.Ts(document.getElementById("sankey")),this.myChartsankey.setOption(l),window.addEventListener("resize",(()=>{this.myChartsankey.resize()}))},async GetThreatLogs(){let t=await Ma();this.threatlogs=t,this.gethosts(),this.initEchartsbar(),this.initEchartslogs(),this.initEchartstimeline(),this.initSankey()},refresh(t){console.log(t),this.host=t;let e=[],a=0;for(let c of this.tactics){e[a]=0;for(let s of this.threatlogs)s.tactic_id==c&&s.host==t&&e[a]++;a++}let s=[];for(let c of this.tactics){let t={name:"",value:0,depth:1,itemStyle:{color:""}};t.name=c,t.value=0,t.itemStyle.color=this.getRandomColor(),console.log(t),s.push(t)}let l=0;for(let c of this.threatlogs)for(let e of s)c.tactic_id==e.name&&c.host==t&&(e.value+=1,l+=1);console.log(s);let o={name:t,value:l,depth:0,itemStyle:{color:"#7BA2DF"}};s.push(o);let i=[];for(let c of s){let e={source:t,target:"",value:0};1==c.depth&&(e.target=c.name,e.value=c.value,i.push(e))}console.log(i);const n={title:{text:"行为统计",x:"center",textStyle:{fontSize:20,fontStyle:"italic",fontWeight:"bold"}},xAxis:{name:"技术",data:this.tactics},yAxis:{name:"告警个数"},series:[{type:"bar",data:e,label:{show:!0,position:"top"},barWidth:"30%"}]},r={tooltip:{trigger:"item",triggerOn:"mousemove",rich:{a:{fontSize:14,fontWeight:500,color:"#fff",padding:[0,0,5,0]}},formatter:function(t){return t.data.source?`${t.data.source}-${t.data.target}：${t.data.value}`:`${t.name}：${t.value}`}},series:{type:"sankey",layout:"none",top:"1%",bottom:"1%",left:"0",right:"16.5%",draggable:!1,focusNodeAdjacency:"allEdges",lineStyle:{opacity:.3,color:"gradient",curveness:.7},label:{color:"#000",fontSize:15,formatter:function(t){if(0===t.data.depth&&"本科生"===t.data.name)return"{a|"+t.data.name+"\n}{b|"+t.data.value+"}";if(0===t.data.depth&&"硕士研究生"===t.data.name)return"{a2|"+t.data.name+"\n}{b2|"+t.data.value+"}";if(0===t.data.depth&&"博士研究生"===t.data.name)return"{a3|"+t.data.name+"\n}{b3|"+t.data.value+"}";if(1===t.data.depth)return"{c|"+t.data.name+"}{d|"+t.data.value+"}";if(2===t.data.depth){let e="";return t.data.typeArr.forEach((a=>{e+="{m|"+t.data.name+"/"+a.typeName+"}{n|"+a.value+"\n}"})),e}},rich:{a:{fontSize:14,fontWeight:500,color:"#7BA2DF",padding:[0,0,5,0]},b:{fontSize:24,fontWeight:600,color:"#7BA2DF",padding:[0,0,0,0]},a2:{fontSize:14,fontWeight:500,color:"#BA86ED",padding:[0,0,5,0]},b2:{fontSize:24,fontWeight:600,color:"#BA86ED",padding:[0,0,0,0]},a3:{fontSize:14,fontWeight:500,color:"#59DEC6",padding:[0,0,5,0]},b3:{fontSize:24,fontWeight:600,color:"#59DEC6",padding:[0,0,0,0]},c:{fontSize:16,color:"#332D2D",lineHeight:20},d:{fontSize:16,fontWeight:600,lineHeight:20,color:"#332D2D ",padding:[0,0,0,2]},e:{fontSize:14,fontWeight:500,color:"#332D2D",padding:[0,0,5,0]},f:{fontSize:16,fontWeight:600,color:"#332D2D",padding:[0,0,20,0]},m:{fontSize:14,fontWeight:500,color:"#332D2D",padding:[0,0,0,0]},n:{fontSize:16,fontWeight:600,color:"#332D2D",padding:[0,0,0,10]}}},nodeGap:20,layoutIterations:0,emphasis:{focus:"adjacency"},data:s,links:i}};this.myChartbar.setOption(n),this.myChartsankey.setOption(r)},gethosts(){let t=new Set;for(let a of this.threatlogs)t.add(a.host);let e=Array.from(t);for(let a of e){let t={value:a,label:a};this.hosts.push(t)}this.host=this.hosts[0].value,console.log(this.hosts)},getRandomColor(){var t=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),a=Math.floor(256*Math.random()),s="#"+t.toString(16).padStart(2,"0")+e.toString(16).padStart(2,"0")+a.toString(16).padStart(2,"0");return s}},mounted(){this.GetThreatLogs()}},As=Ss,Ds=(0,r.A)(As,Cs,xs,!1,null,null,null),zs=Ds.exports,$s=function(){var t=this,e=t._self._c;return e("div",[t._m(0),e("div",{staticClass:"wrapper2"},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"},[e("h1",[t._v(" 主机个数："+t._s(this.num)+" ")])])])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content bg-purple-dark"},[e("h1",[t._v(" 威胁情况 ")])])])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"},[e("div",[e("div",{staticClass:"echart",style:t.myChartStyle1,attrs:{id:"sankey"}})])])])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content bg-purple-dark"},[e("h1",[t._v(" 事件概览 ")])])])],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("div",[e("div",{staticClass:"echart",style:t.myChartStyle,attrs:{id:"mycharttimeline"}})])]),e("el-col",{attrs:{span:12}},[e("div",[e("div",{staticClass:"echart",style:t.myChartStyle,attrs:{id:"mychartcases"}})])])],1)],1)])},Es=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header2"},[e("h3",[t._v(" 首页 ")])])}],Ws={data(){return{num:0,myChartStyle:{float:"left",width:"70%",height:"250px"},threatlogs:[],myChartStyle1:{float:"left",width:"100%",height:"400px"},tactics:[],host:"",hosts:[],case_log:[],case_logg:[],case_timeline:[],case_count:[],solve_timeline:[],solve_count:[]}},methods:{gethosts(){let t=new Set;for(let a of this.threatlogs)t.add(a.host);let e=Array.from(t);for(let a of e){let t={value:a,label:a};this.hosts.push(t)}this.host=this.hosts[0].value,console.log("hosts",this.hosts),this.num=this.hosts.length},async GetThreatLogs(){let t=await Ma();this.threatlogs=t,console.log("threatlog",this.threatlogs);let e=new Set;for(let s of this.threatlogs)e.add(s.tactic_id);let a=Array.from(e);this.tactics=a,console.log("tactics",this.tactics),this.gethosts(),this.initSankey(),this.getcasetimeline(),this.initEchartslogs()},initSankey(){let t=[];for(let n of this.tactics){let e={name:"",value:0,depth:1,itemStyle:{color:""}};e.name=n,e.value=0,e.itemStyle.color=this.getRandomColor(),console.log(e),t.push(e)}let e=[],a=0;for(let n of this.hosts){let s=0;for(let e of this.threatlogs)for(let a of t)e.tactic_id==a.name&&e.host==n.value&&(a.value+=1,s+=1);e.push(s),a+=1}let s=0;for(let n of this.hosts){let a={name:n.value,value:e[s],depth:0,itemStyle:{color:""}};a.itemStyle.color=this.getRandomColor(),t.push(a),s+=1}console.log("allDATA",t);let l=[],o=[];for(let n of this.hosts)for(let t of this.tactics){let e={name:n.value,value:0,target:t};o.push(e)}for(let n of this.threatlogs)for(let t of o)n.host==t.name&&n.tactic_id==t.target&&(t.value+=1);console.log("jishu",o);for(let n of o)if(0!=n.value){let t={source:n.name,target:n.target,value:n.value};l.push(t)}console.log(l);const i={tooltip:{trigger:"item",triggerOn:"mousemove",rich:{a:{fontSize:14,fontWeight:500,color:"#fff",padding:[0,0,5,0]}},formatter:function(t){return t.data.source?`${t.data.source}-${t.data.target}：${t.data.value}`:`${t.name}：${t.value}`}},series:{type:"sankey",layout:"none",top:"1%",bottom:"1%",left:"0",right:"16.5%",draggable:!1,focusNodeAdjacency:"allEdges",lineStyle:{opacity:.3,color:"gradient",curveness:.7},label:{color:"#000",fontSize:15,formatter:function(t){if(0===t.data.depth&&"本科生"===t.data.name)return"{a|"+t.data.name+"\n}{b|"+t.data.value+"}";if(0===t.data.depth&&"硕士研究生"===t.data.name)return"{a2|"+t.data.name+"\n}{b2|"+t.data.value+"}";if(0===t.data.depth&&"博士研究生"===t.data.name)return"{a3|"+t.data.name+"\n}{b3|"+t.data.value+"}";if(1===t.data.depth)return"{c|"+t.data.name+"}{d|"+t.data.value+"}";if(2===t.data.depth){let e="";return t.data.typeArr.forEach((a=>{e+="{m|"+t.data.name+"/"+a.typeName+"}{n|"+a.value+"\n}"})),e}},rich:{a:{fontSize:14,fontWeight:500,color:"#7BA2DF",padding:[0,0,5,0]},b:{fontSize:24,fontWeight:600,color:"#7BA2DF",padding:[0,0,0,0]},a2:{fontSize:14,fontWeight:500,color:"#BA86ED",padding:[0,0,5,0]},b2:{fontSize:24,fontWeight:600,color:"#BA86ED",padding:[0,0,0,0]},a3:{fontSize:14,fontWeight:500,color:"#59DEC6",padding:[0,0,5,0]},b3:{fontSize:24,fontWeight:600,color:"#59DEC6",padding:[0,0,0,0]},c:{fontSize:16,color:"#332D2D",lineHeight:20},d:{fontSize:16,fontWeight:600,lineHeight:20,color:"#332D2D ",padding:[0,0,0,2]},e:{fontSize:14,fontWeight:500,color:"#332D2D",padding:[0,0,5,0]},f:{fontSize:16,fontWeight:600,color:"#332D2D",padding:[0,0,20,0]},m:{fontSize:14,fontWeight:500,color:"#332D2D",padding:[0,0,0,0]},n:{fontSize:16,fontWeight:600,color:"#332D2D",padding:[0,0,0,10]}}},nodeGap:20,layoutIterations:0,emphasis:{focus:"adjacency"},data:t,links:l}};this.myChartsankey=ks.Ts(document.getElementById("sankey")),this.myChartsankey.setOption(i),window.addEventListener("resize",(()=>{this.myChartsankey.resize()}))},initEchartstimeline(){const t={title:{text:"事件创建时间线",x:"center",textStyle:{fontSize:20,fontStyle:"italic",fontWeight:"bold"}},xAxis:{name:"时间",type:"category",data:this.case_timeline},yAxis:{type:"value",name:"事件个数"},series:[{type:"line",data:this.case_count,label:{show:!0,position:"top"},barWidth:"30%"}]};this.myCharttimeline=ks.Ts(document.getElementById("mycharttimeline")),this.myCharttimeline.setOption(t),window.addEventListener("resize",(()=>{this.myCharttimeline.resize()}))},async getcasetimeline(){let t=await Ia();this.case_log=t;for(let l of this.case_log)1==l.is_escalated&&this.case_logg.push(l);console.log("case_log",this.case_logg);let e=[],a=new Set;for(let l of this.case_logg){const t=new Date(l.create_time),e=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),i=`${e}-${s}-${o}`;a.add(i)}console.log(a);for(let l of a){let t={time:l,case_count:0};e.push(t)}for(let l of this.case_logg){const t=new Date(l.create_time),a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),i=`${a}-${s}-${o}`;for(let l of e)l.time==i&&(l.case_count+=1)}for(let l of e)this.case_timeline.push(l.time),this.case_count.push(l.case_count);console.log(this.case_timeline,this.case_count);let s=[];for(let l of this.case_log)0==l.is_opened&&1==l.is_escalated&&s.push(l);console.log("close",s),this.initEchartstimeline(),this.initEchartslogs()},initEchartslogs(){const t={title:{text:"事件解决统计",x:"center",textStyle:{fontSize:20,fontStyle:"italic",fontWeight:"bold"}},xAxis:{name:"日期",data:this.solve_timeline},yAxis:{name:"事件解决个数"},series:[{type:"bar",data:this.solve_count,label:{show:!0,position:"top"},barWidth:"30%"}]};this.myChartlog=ks.Ts(document.getElementById("mychartcases")),this.myChartlog.setOption(t),window.addEventListener("resize",(()=>{this.myChartlog.resize()}))},getRandomColor(){var t=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),a=Math.floor(256*Math.random()),s="#"+t.toString(16).padStart(2,"0")+e.toString(16).padStart(2,"0")+a.toString(16).padStart(2,"0");return s}},mounted(){this.GetThreatLogs()}},Gs=Ws,Os=(0,r.A)(Gs,$s,Es,!1,null,"861a8468",null),qs=Os.exports,js=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},Ms=[],Bs={data(){return{}},methods:{}},Is=Bs,Ls=(0,r.A)(Is,js,Ms,!1,null,null,null),Fs=Ls.exports,Ns=function(){var t=this,e=t._self._c;return e("div",[t._m(0),e("div",{staticClass:"wrapper1"},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"})])],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:8}},[e("div",{staticClass:"grid-content bg-purple"},[e("h3",[t._v(" 选择刷新间隔 ")]),e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"刷新间隔"},model:{value:t.value[1],callback:function(e){t.$set(t.value,1,e)},expression:"value[1]"}},[e("template",{slot:"prefix"},[e("span",{staticStyle:{padding:"5px","line-height":"33px","font-size":"18px",color:"#409eff"}},[e("i",{staticClass:"el-icon-refresh"})])]),t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],2)],1)]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"grid-content bg-purple-light"},[e("h3",[t._v(" 选择时间范围 ")]),e("div",{staticClass:"block"},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}})],1)])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"grid-content bg-purple"},[e("h3",[t._v(" 输入抓取条目数 ")]),e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"条目数"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}},[e("template",{slot:"prefix"},[e("span",{staticStyle:{padding:"5px","line-height":"33px","font-size":"18px",color:"#409eff"}},[e("i",{staticClass:"el-icon-edit"})])]),t._l(t.numss,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],2)],1)])],1),[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.threatdata1,stripe:""}},[e("el-table-column",{attrs:{prop:"severity",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{staticClass:"el-icon-message-solid",style:"informational"==a.row.severity?t.styleinfo:"low"==a.row.severity?t.stylelow:"medium"==a.row.severity?t.stylemedium:t.stylehigh})]}}])}),e("el-table-column",{attrs:{prop:"count",label:"总数",width:"100"}}),e("el-table-column",{attrs:{prop:"rule_name",label:"规则名称",width:"400"}}),e("el-table-column",{attrs:{prop:"severity",label:"事件威胁程度",width:"150"}}),e("el-table-column",{attrs:{prop:"rule_id",label:"规则id",width:"600"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.AlertDetail(a.$index,a.row)}}},[t._v("详情")])]}}])})],1)],e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],2)])},Rs=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header1"},[e("h3",[t._v(" 告警详情 ")])])}],Ps=function(){var t=this,e=t._self._c;return e("div",[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},Vs=[],Hs={props:{total:{type:Number,default:100}},methods:{handleSizeChange(t){console.log(`每页 ${t} 条`)},handleCurrentChange(t){console.log(`当前页: ${t}`),this.$emit("CurrentChange",t)}},data(){return{currentPage:1}}},Js=Hs,Us=(0,r.A)(Js,Ps,Vs,!1,null,"78c7fcc8",null),Ys=Us.exports,Ks={components:{Pagination:Ys},data(){return{options:[{label:"从不",value:0},{label:"30秒",value:.5},{label:"1分钟",value:1},{label:"2分钟",value:2}],numss:[{label:"300条",value:300},{label:"500条",value:500},{label:"1000条",value:1e3}],value:[],value2:!0,pickerOptions:{shortcuts:[{text:"最近一周",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},value1:[new Date(2e3,10,10,10,10),new Date(2e3,10,11,10,10)],value2:"",input:"",threatlogs:[],threatdata:[],threatdataes:[],threatdata1:[],styleinfo:"color: aqua;",stylelow:"color: yellow;",stylemedium:"color: orange",stylehigh:"color: red",total:0}},methods:{async GetThreatLogs(){let t=await Ma();this.threatlogs=t,console.log(this.threatlogs);let e=new Set,a=[];for(let l of this.threatlogs)e.add(l.rule_name),a.push(l.log_id);console.log(a);let s=Array.from(e);console.log(s);for(let l of s){let t={count:0,severity:"",rule_name:"",rule_id:"",is_escalated:!1};t.rule_name=l;for(let e of this.threatlogs)if(e.rule_name==l){t.rule_id=e.rule_id,t.severity=e.severity;break}this.threatdata.push(t)}for(let l of this.threatlogs)for(let t of this.threatdata)if(l.rule_name==t.rule_name){t.count++;break}for(let l of this.threatlogs){await Ba({param:l})}this.total=this.threatdata.length,this.logshow(1)},AlertDetail(t,e){console.log(t,e),this.showdetail(e)},showdetail(t){this.$router.push({path:"/alert/alertdetail",query:{index:t}})},logshow(t){this.threatdata1=this.threatdata.slice(10*(t-1),10*t),console.log(this.threatdata1)},CurrentChange(t){console.log("頁嗎",t),this.logshow(t),this.page=t},async changeStatus(){console.log(this.value2);let t=this.threatdata;if(console.log(t),0==value2)for(let e of t)e.is_escalated}},created(){this.GetThreatLogs()}},Xs=Ks,Qs=(0,r.A)(Xs,Ns,Rs,!1,null,null,null),Zs=Qs.exports,tl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header1"},[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),e("h3",[t._v("     告警详情 ")])],1),e("div",{staticClass:"wrapper1"},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"})])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"},[e("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"未标记为事件的告警","inactive-text":"已标记为事件的告警"},on:{change:t.changeStatus},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}})],1)])],1),e("el-container",[[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.threatdata1,stripe:""}},[e("el-table-column",{attrs:{prop:"level",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{staticClass:"el-icon-message-solid",style:"informational"==a.row.severity?t.styleinfo:"low"==a.row.severity?t.stylelow:t.stylehigh})]}}])}),e("el-table-column",{attrs:{prop:"severity",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{class:a.row.is_escalated?t.icon_star_on:t.icon_star_off})]}}])}),e("el-table-column",{attrs:{prop:"rule_name",label:"规则名称",width:"250"}}),e("el-table-column",{attrs:{prop:"rule_id",label:"规则id",width:"500"}}),e("el-table-column",{attrs:{prop:"tactic_id",label:"规则战术",width:"100"}}),e("el-table-column",{attrs:{prop:"technique_id",label:"规则技术",width:"100"}}),e("el-table-column",{attrs:{prop:"log_id",label:"告警日志id",width:"300"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.AlertDetail(a.$index,a.row)}}},[t._v("详情")]),e("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-upload2"},on:{click:function(e){return t.CaseCreate(a.$index,a.row)}}},[t._v("提升为事件")]),e("el-dialog",{attrs:{title:"添加事件",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("el-form",[e("el-form-item",{attrs:{label:"事件名称","label-width":t.formLabelWidth}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.case_name,callback:function(e){t.case_name=e},expression:"case_name"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Escalate_log()}}},[t._v("确 定")])],1)],1)]}}])})],1)]],2),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},el=[],al={components:{Pagination:Ys},data(){return{rule_name:this.$route.query.index.rule_name,threatlogs:[],threatdata:[],styleinfo:"color: aqua;",stylelow:"color: yellow;",stylemedium:"color: orange",stylehigh:"color: red",total:20,page:1,threatdata1:[],value2:0,log_is_escalated:[],icon_star_on:"el-icon-star-on",icon_star_off:"el-icon-star-off",dialogFormVisible:!1,case_name:"",formLabelWidth:"120px",index:0,row:{}}},methods:{Goback(){this.$router.push("/alert/index")},async getthreadlog(){this.threatlogs=[],this.threatdata=[];let t=await Ma();this.threatlogs=t;for(let a of this.threatlogs)a.rule_name==this.rule_name&&this.threatdata.push(a);this.total=this.threatdata.length;let e=await Ia();this.log_is_escalated=e;for(let a of this.threatdata)for(let t of this.log_is_escalated)a.log_id==t.log_id&&(a["is_escalated"]=t.is_escalated);console.log("threat_data:",this.threatdata),this.logshow(this.page)},logshow(t){this.threatdata1=this.threatdata.slice(10*(t-1),10*t),console.log("threatdata1:",this.threatdata1)},CurrentChange(t){console.log("頁嗎",t),this.logshow(t),this.page=t},async Escalate_log(){console.log(this.case_name);let t=this.hashString(this.case_name),e={case_name:this.case_name,log_id:this.row.log_id,case_id:t};console.log(e);await La({param:e});this.getthreadlog(),this.dialogFormVisible=!1},AlertDetail(t,e){console.log(t,e),this.showdetail(e)},hashString(t){let e=0;for(let a of t)e=(e<<5)-e+a.charCodeAt(0);return t=e.toString(),t},CaseCreate(t,e){this.dialogFormVisible=!0,this.index=t,this.row=e},showdetail(t){this.$router.push({path:"/alert/logdetail",query:{index:t}})}},created(){console.log("111"),this.getthreadlog()}},sl=al,ll=(0,r.A)(sl,tl,el,!1,null,null,null),ol=ll.exports,il=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header1"},[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),e("h3",[t._v("     日志详情 ")])],1),e("div",{staticClass:"wrapper1"},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"},[e("h3",[t._v(" 日志id："+t._s(t.log_data.log_id)+" ")])])])],1),e("el-descriptions",{attrs:{column:"2",border:""}},[e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("日志源")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.host)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("ID")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.log_id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("是否被标记为事件")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.is_escalated)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("规则名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.rule_name)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("规则id")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.rule_id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("所属战术id")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.tactic_id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("所属技术id")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.technique_id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("严重程度")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.severity)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("时间戳")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.timestamp)+" ")])])],1),e("h3",[t._v(" 日志告警信息： ")]),e("div",[e("json-viewer",{staticClass:"w-100%",attrs:{value:t.log_info,"expand-depth":5,copyable:"",boxed:"",sort:""}})],1)],1)])},nl=[],rl=a(25734),cl=a.n(rl),dl={components:{Pagination:Ys,JsonViewer:cl()},data(){return{log_data:this.$route.query.index,log_info:JSON.parse(this.$route.query.index.log_info)}},methods:{Goback(){this.$router.push("/alert/index")}},created(){console.log("111"),console.log(this.log_data)}},hl=dl,ul=(0,r.A)(hl,il,nl,!1,null,null,null),pl=ul.exports,fl=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},gl=[],ml={data(){return{}},methods:{}},vl=ml,_l=(0,r.A)(vl,fl,gl,!1,null,null,null),yl=_l.exports,bl=function(){var t=this,e=t._self._c;return e("div",[t._m(0),e("div",{staticClass:"wrapper1"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[e("h3",[t._v(" 选择时间范围 ")]),e("div",{staticClass:"block"},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",align:"right"},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}})],1)])]),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[e("h3",[t._v(" 选择事件筛选类型 ")]),e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"事件类型"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}},[e("template",{slot:"prefix"},[e("span",{staticStyle:{padding:"5px","line-height":"33px","font-size":"18px",color:"#409eff"}},[e("i",{staticClass:"el-icon-edit"})])]),t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],2)],1)])],1),[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.case_log1,stripe:""}},[e("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"300"}}),e("el-table-column",{attrs:{prop:"case_name",label:"标题",width:"100"}}),e("el-table-column",{attrs:{prop:"rule_name",label:"规则名称",width:"400"}}),e("el-table-column",{attrs:{prop:"severity",label:"事件威胁程度",width:"150"}}),e("el-table-column",{attrs:{prop:"rule_id",label:"规则id",width:"400"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.CaseDetail(a.$index,a.row)}}},[t._v("事件详情")])]}}])})],1)],e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],2)])},Tl=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header1"},[e("h3",[t._v(" 事件 ")])])}],wl={components:{Pagination:Ys},data(){return{options:[{label:"开启",value:0},{label:"关闭",value:1},{label:"所有",value:2}],value:[],value2:!0,pickerOptions:{shortcuts:[{text:"最近一周",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},value1:[new Date(2e3,10,10,10,10),new Date(2e3,10,11,10,10)],value2:"",input:2,case_log:[],case_logg:[],case_log1:[],showlog:[],styleinfo:"color: aqua;",stylelow:"color: yellow;",stylemedium:"color: orange",stylehigh:"color: red",total:0}},methods:{async get_case(){let t=await Ia();this.case_log=t;for(let e of this.case_log)1==e.is_escalated&&this.case_logg.push(e);this.total=this.case_logg.length,this.logshow(1)},logshow(t){this.case_log1=this.case_logg.slice(10*(t-1),10*t),console.log(this.case_log1)},CaseDetail(t,e){this.showdetail(e)},showdetail(t){this.$router.push({path:"/case/casedetail",query:{index:t}})}},created(){this.get_case()}},Cl=wl,xl=(0,r.A)(Cl,bl,Tl,!1,null,null,null),kl=xl.exports,Sl=function(){var t=this,e=t._self._c;return e("div",[e("router-view",{attrs:{caseData:t.caseData}})],1)},Al=[],Dl={data(){return{activeIndex:"1",Data:[],host:[],caseData:this.$route.query.index,total:0,hostDD:[],task_time:0,id:"",page:1}},methods:{Gonext(){this.$router.push("/case/casedetail/root_clue")}},created(){console.log("lllklkl",this.$route.query.index),this.Gonext()}},zl=Dl,$l=(0,r.A)(zl,Sl,Al,!1,null,"ccbe12b0",null),El=$l.exports,Wl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header1"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 事件详情:"+t._s(this.caseData.case_name)+" ")],1)]),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.$route.path,mode:"horizontal",router:"","background-color":"#409eff","text-color":"#fff","active-text-color":"#ffd04b"}},[e("el-menu-item",{attrs:{index:"/case/casedetail/root_clue"}},[t._v("根线索")]),e("el-menu-item",{attrs:{index:"/case/casedetail/traceability_diagram"}},[t._v("溯源图")]),e("el-menu-item",{attrs:{index:"/case/casedetail/disposal_record"}},[t._v("处置记录")])],1),e("div",{staticClass:"wrapper1"},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"},[e("h3",[t._v(" 日志id："+t._s(t.log_data.log_id)+" ")])])])],1),e("el-descriptions",{attrs:{column:"2",border:""}},[e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("日志源")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.host)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("ID")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.log_id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("规则名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.rule_name)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("规则id")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.rule_id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("所属战术id")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.tactic_id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("所属技术id")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.technique_id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("严重程度")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.severity)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("时间戳")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.log_data.timestamp)+" ")])])],1),e("h3",[t._v(" 日志告警信息： ")]),e("div",[e("json-viewer",{staticClass:"w-100%",attrs:{value:t.log_info,"expand-depth":5,copyable:"",boxed:"",sort:""}})],1)],1)],1)},Gl=[],Ol={components:{JsonViewer:cl()},data(){return{caseData:this.caseData,log_data:{}}},props:{caseData:{type:Array,default:()=>[]}},methods:{Goback(){this.$router.push("/case/index")},async getRootCase(){let t=await Ma();for(let e of t)if(e.log_id==this.caseData.log_id){this.log_data=e;break}this.log_info=JSON.parse(this.log_data.log_info)}},created(){console.log("chuang!!",this.caseData),console.log("log all"),this.getRootCase()}},ql=Ol,jl=(0,r.A)(ql,Wl,Gl,!1,null,"189aab14",null),Ml=jl.exports,Bl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header1"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 事件详情:"+t._s(this.caseData.case_name)+" ")],1)]),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.$route.path,mode:"horizontal",router:"","background-color":"#409eff","text-color":"#fff","active-text-color":"#ffd04b"}},[e("el-menu-item",{attrs:{index:"/case/casedetail/root_clue"}},[t._v("根线索")]),e("el-menu-item",{attrs:{index:"/case/casedetail/traceability_diagram"}},[t._v("溯源图")]),e("el-menu-item",{attrs:{index:"/case/casedetail/disposal_record"}},[t._v("处置记录")])],1),e("div",{staticClass:"wrapper1"},[[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("创建图表")]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:this.knowlegGraphshow,expression:"this.knowlegGraphshow"}],staticClass:"wrapper1",staticStyle:{border:"1px solid black"}},[e("el-row",[e("el-col",{attrs:{span:20}},[e("div",{staticClass:"grid-content bg-purple"},[e("div",{ref:"network_id",staticClass:"network",staticStyle:{height:"700px",width:"1400px"},attrs:{id:"network_id"}})])]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"grid-content bg-purple"},[e("el-descriptions",{staticStyle:{height:"300px",width:"300px"},attrs:{column:1,border:""}},[t._l(t.clientInfo.contactInfo,(function(a,s){return[e("el-descriptions-item",{key:s,attrs:{label:"联系人"}},[t._v(t._s(a.contactPerson))]),e("el-descriptions-item",{key:s,attrs:{label:"联系电话"}},[t._v(t._s(a.contactPhone))])]}))],2)],1)])],1)],1)],2)],1)},Il=[];const Ll=Oa.A.create({baseURL:"/gra"}),Fl=t=>Ll.post("/graphconstruct",{data:t}),Nl=t=>Ll.post("/subgraphconstruct",{data:t}),Rl=a(76863);a(20164);var Pl,Vl,Hl,Jl,Ul=a(57859),Yl={data(){return{caseData:this.caseData,echartsNode:[],nodesRelation:[],clearAll:!1,nodesArray:[],echartsData:[],edgesArray:[],knowlegGraphshow:!0,records:[],log_data:{},options:[{label:"显示全图",value:"all"},{label:"显示前向图",value:"forward"},{label:"显示后向图",value:"back"}],value:"all",node_color:{file:"blue",threat:"yellow",process:"purple",fdpair:"orange",network_socket:"grey",directory:"green",named_pipe:"red",unknown:"black",unix_socket:"brown"}}},props:{caseData:{type:Array,default:()=>[]}},methods:{Goback(){this.$router.push("/case/index")},async getRootCase(){let t=await Ma();for(let e of t)if(e.log_id==this.caseData.log_id){this.log_data=e;break}console.log("4124124",this.log_data),this.Graph_construct()},executeCypher(t){this.echartsNode=[],this.nodesRelation=[],this.driver=Ul.driver("bolt://10.114.23.20:7687",Ul.auth.basic("neo4j","12345678")),console.log("🚀 ~ file: AuthorArticleSearch.vue ~ line 46 ~ mounted ~  this.drive",this.driver);let e=this;e.records=[],this.clearAll=!0;let a=this.driver.session();""!=t&&(a.run(t,{}).then((t=>{e.clearAll=!1,e.records=t.records,console.log("neo4j 查询结果",t.records);let s=new Set;for(let a=0;a<e.records.length;a++)s.add(e.records[a]._fields[0].segments[0].relationship.startNodeElementId),s.add(e.records[a]._fields[0].segments[0].relationship.endNodeElementId),this.nodesRelation.push({from:e.records[a]._fields[0].segments[0].relationship.startNodeElementId,to:e.records[a]._fields[0].segments[0].relationship.endNodeElementId,label:e.records[a]._fields[0].segments[0].relationship.type,id:a});let l=[];for(let a=0;a<e.records.length;a++)console.log("2"),l.push({id:e.records[a]._fields[0].segments[0].relationship.startNodeElementId,name:e.records[a]._fields[0].segments[0].start.properties.name,inode:e.records[a]._fields[0].segments[0].start.properties.inode,type:e.records[a]._fields[0].segments[0].start.labels[0],fd1:e.records[a]._fields[0].segments[0].start.properties.fd1,remote_host:e.records[a]._fields[0].segments[0].start.properties.remote_host}),l.push({id:e.records[a]._fields[0].segments[0].relationship.endNodeElementId,name:e.records[a]._fields[0].segments[0].end.properties.name,inode:e.records[a]._fields[0].segments[0].end.properties.inode,type:e.records[a]._fields[0].segments[0].end.labels[0],fd1:e.records[a]._fields[0].segments[0].end.properties.fd1,remote_host:e.records[a]._fields[0].segments[0].end.properties.remote_host});console.log(l),s.forEach((t=>{console.log("1");for(let e=0;e<l.length;e++)if(t==l[e].id){if(void 0!=l[e].name){this.echartsData.push({label:l[e].name,id:t,color:this.node_color[l[e].type]});break}if(void 0!=l[e].inode){this.echartsData.push({label:l[e].inode,id:t,color:this.node_color[l[e].type]});break}if(void 0!=l[e].fd1){this.echartsData.push({label:l[e].fd1,id:t,color:this.node_color[l[e].type]});break}if(void 0!=l[e].remote_host){this.echartsData.push({label:l[e].remote_host,id:t,color:this.node_color[l[e].type]});break}}})),a.close(),e.closeLoading(!1),this.nodesArray=this.echartsData,this.edgesArray=this.nodesRelation,this.visDraw(),console.log(this.nodesArray)})).catch((function(t){console.log("Cypher 执行失败！",t),e.driver.close()})),setTimeout((()=>{this.knowlegGraphshow=!1}),4e3))},closeLoading(t){console.log("closeLoading",t)},visDraw(){let t=this.$refs.network_id,e={nodes:this.nodesArray,edges:this.edgesArray};console.log("🚀 ~ file: pageKnowlegGraph.vue ~ line 135 ~ visDraw ~ data",e);let a={autoResize:!0,nodes:{shape:"dot",size:20,font:{size:20},color:{background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},borderWidth:0,borderWidthSelected:2},edges:{width:1,length:260,color:{color:"#848484",highlight:"#848484",hover:"#848484",inherit:"from",opacity:1},shadow:!1,smooth:{enabled:!0},arrows:{to:!0}},physics:{barnesHut:{gravitationalConstant:-4e3,centralGravity:.3,springLength:120,springConstant:.04,damping:.09,avoidOverlap:0},stabilization:{enabled:!0,iterations:5e3}},interaction:{hover:!0,dragNodes:!0,dragView:!0,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0,zoomView:!0}};this.network=new Rl.Network(t,e,a),this.network.on("selectNode",(t=>{console.log("select",t.nodes[0]);let e=t.nodes[0];this.generate_node_info(e)})),this.knowlegGraphshow=!1,console.log(this.knowlegGraphshow)},check(){var t=document.getElementById("network_id");t?console.log("div元素存在"):console.log("div元素不存在")},async Graph_construct(){this.caseData.host;await Fl({index:this.caseData.host,log_id:this.log_data.log_id,timerange:[1,"h",1,"h"]});var t="USE "+this.log_data.host+"1 MATCH p=()--\x3e() RETURN p";this.executeCypher(t)},generate_node_info(t){},onSubmit(){this.getnodelog()},async getnodelog(){let t=await Fa(),e={};for(let a of t)a.log_id==this.caseData.log_id&&(e=a);if("all"!=this.value){await Nl({index:this.caseData.host,node:e.vertex,direction:this.value,hop:3,time:e.timestamp})}}},mounted(){this.getRootCase(),this.timer=setInterval(this.check,3e3);console.log(this.knowlegGraphshow),console.log(this.caseData.host)},beforeDestroy(){clearInterval(this.timer)}},Kl=Yl,Xl=(0,r.A)(Kl,Bl,Il,!1,null,"49259059",null),Ql=Xl.exports,Zl={},to=(0,r.A)(Zl,Pl,Vl,!1,null,null,null),eo=to.exports,ao={},so=(0,r.A)(ao,Hl,Jl,!1,null,null,null),lo=so.exports,oo=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header1"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 事件详情:"+t._s(this.caseData.case_name)+" ")],1)]),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.$route.path,mode:"horizontal",router:"","background-color":"#409eff","text-color":"#fff","active-text-color":"#ffd04b"}},[e("el-menu-item",{attrs:{index:"/case/casedetail/root_clue"}},[t._v("根线索")]),e("el-menu-item",{attrs:{index:"/case/casedetail/traceability_diagram"}},[t._v("溯源图")]),e("el-menu-item",{attrs:{index:"/case/casedetail/disposal_record"}},[t._v("处置记录")])],1),e("div",{staticClass:"wrapper1"},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"grid-content"},[e("h3",[t._v(" 处置记录 ")])])])],1),e("el-input",{attrs:{type:"textarea",autosize:{minRows:20,maxRows:20},placeholder:"处置记录输入"},model:{value:t.textarea2,callback:function(e){t.textarea2=e},expression:"textarea2"}}),e("el-row"),e("el-button",{attrs:{type:"primary",disabled:"1"!=this.caseData.is_open},on:{click:t.onSubmit}},[t._v("提交处置结果并关闭事件")])],1)],1)},io=[],no={components:{JsonViewer:cl()},data(){return{caseData:this.caseData,log_data:{},textarea2:""}},props:{caseData:{type:Array,default:()=>[]}},methods:{Goback(){this.$router.push("/case/index")},async getRootCase(){let t=await Ma();for(let e of t)if(e.log_id==this.caseData.log_id){this.log_data=e;break}this.log_info=JSON.parse(this.log_data.log_info)},async onSubmit(){let t={text:this.textarea2,case_id:this.caseData.case_id};await Na({param:t});this.Goback()}},created(){console.log("chuang!!",this.caseData),console.log("log all"),this.getRootCase(),this.textarea2=this.caseData.disposal_record}},ro=no,co=(0,r.A)(ro,oo,io,!1,null,"2d630b0c",null),ho=co.exports;s["default"].use(na.Ay);const uo=[{path:"/",component:ka,children:[{path:"/",name:"home",component:qs},{path:"/matrix",name:"matrix",component:Ea,children:[{path:"index",name:Ha,component:Ha},{path:"detail",name:ms,component:ms}]},{path:"/danger",name:"danger",component:Qa,children:[{path:"index",name:ls,component:ls},{path:"detail",name:ds,component:ds}]},{path:"/dashboard",name:"dashboard",component:ws,children:[{path:"index",name:zs,component:zs}]},{path:"/alert",name:"alert",component:Fs,children:[{path:"index",name:Zs,component:Zs},{path:"alertdetail",name:ol,component:ol},{path:"logdetail",name:pl,component:pl}]},{path:"/case",name:"case",component:yl,children:[{path:"index",name:kl,component:kl},{path:"casedetail",name:El,component:El,children:[{path:"root_clue",name:Ml,component:Ml},{path:"traceability_diagram",name:Ql,component:Ql},{path:"disposal_record",name:ho,component:ho}]}]},{path:"/rules",name:"rules",component:eo,children:[{path:"index",name:lo,component:lo}]}]}],po=new na.Ay({mode:"history",historyApiFallback:!0,routes:uo});var fo=po,go=a(93518);s["default"].use(go.Ay);var mo=new go.Ay.Store({state:{},getters:{},mutations:{},actions:{},modules:{}}),vo=a(19122),_o=a.n(vo);new s["default"]({render:t=>t(d),router:fo,store:mo,qs:_o()}).$mount("#app")},42634:function(){}},e={};function a(s){var l=e[s];if(void 0!==l)return l.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,a),o.exports}a.m=t,function(){var t=[];a.O=function(e,s,l,o){if(!s){var i=1/0;for(d=0;d<t.length;d++){s=t[d][0],l=t[d][1],o=t[d][2];for(var n=!0,r=0;r<s.length;r++)(!1&o||i>=o)&&Object.keys(a.O).every((function(t){return a.O[t](s[r])}))?s.splice(r--,1):(n=!1,o<i&&(i=o));if(n){t.splice(d--,1);var c=l();void 0!==c&&(e=c)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[s,l,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var l,o,i=s[0],n=s[1],r=s[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(l in n)a.o(n,l)&&(a.m[l]=n[l]);if(r)var d=r(a)}for(e&&e(s);c<i.length;c++)o=i[c],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(d)},s=self["webpackChunkprnvg_fronted"]=self["webpackChunkprnvg_fronted"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(13041)}));s=a.O(s)})();
//# sourceMappingURL=app.d041a67d.js.map